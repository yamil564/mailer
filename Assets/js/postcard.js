autosize($('#baseInstructions'))
autosize($('#contentInstructions'))
autosize($('#imageInstructions'))
function chargePreviewforImage(preview,btn){preview.empty()
let kilobyte=(parseInt(btn.prop('files')[0].size)/1024)
if(btn.prop('files').length!==0&&kilobyte<2048){let reader=new FileReader()
reader.readAsDataURL(btn.prop('files')[0])
reader.onload=function(){let picture=$('<picture>')
let image=$('<img>',{'class':'minis img-'+btn.attr('id'),src:reader.result,alt:btn.prop('files')[0].name})
preview.append(picture.append(image))}
$(".msg_"+btn.attr('name')).removeClass("invalid")
$(".msg_"+btn.attr('name')).empty()}else{message("error","the image is too large (maximum 2MB)","#CC1E1E")
btn.val('')}}
$('#cboSection').change(function(){$('#cboSubsection').empty()
$.ajax({type:'POST',url:$('#ruta').val(),data:{cboSection:$(this).val()},success:function(data){$('#cboSubsection').append(data)}})})
$('#switchmls').on("change",function(){$('.switchmls').empty()
if($(this).prop('checked')){$('.switchmls').text('Active')}else{$('.switchmls').text('Inactive')}})
$('#switchpicture').on("change",function(){$('.switchpicture').empty()
if($(this).prop('checked')){$('.switchpicture').text('Active')}else{$('.switchpicture').text('Inactive')}})
$("#txtBase").keyup(function(){let numberBaseFields=$(this).val()
$("#row-base").empty()
let counterBaseFields=1
while(counterBaseFields<=numberBaseFields){let containerBaseField=$('<div>',{'class':'col-12 col-md-6 col-xl-6 mt-3'})
let labelBaseField=$('<label>',{'class':'form-label',html:'Base fields:'})
let textBaseField=$('<input>',{type:'text',id:'base_'+counterBaseFields,name:'base_'+counterBaseFields,'class':'form-control',placeholder:'Enter a name of base fields',maxLength:50,required:!0})
let instruccionsBaseField=$("<div>",{'class':'msg msg_'+textBaseField.attr('id')})
let containerValidateRequired=$("<div>",{'class':'custom-control custom-radio custom-control-inline'})
let radioValidateRequired=$('<input>',{type:'radio',id:'required_'+counterBaseFields,name:'validate_'+counterBaseFields,'class':'custom-control-input',val:1})
let labelValidateRequired=$('<label>',{for:'required_'+counterBaseFields,'class':'custom-control-label',html:'Required'})
let containerValidateNorequired=$("<div>",{'class':'custom-control custom-radio custom-control-inline'})
let radioValidateNorequired=$('<input>',{type:'radio',id:'norequired_'+counterBaseFields,name:'validate_'+counterBaseFields,'class':'custom-control-input',val:0,checked:!0})
let labelValidateNorequired=$('<label>',{for:'norequired_'+counterBaseFields,'class':'custom-control-label',html:'No required'})
$("#row-base").append(containerBaseField.append(labelBaseField,textBaseField,instruccionsBaseField,containerValidateRequired.append(radioValidateRequired,labelValidateRequired),containerValidateNorequired.append(radioValidateNorequired,labelValidateNorequired)))
counterBaseFields++}})
$("#btnFilefront").change(function(){chargePreviewforImage($('#preview_btnFilefront'),$(this))})
$("input[name='txtNumberFront']").keyup(function(){let numberFieldsFront=$(this).val()
$("#content_fieldsFront").empty()
let counterFieldsFront=1
while(counterFieldsFront<=numberFieldsFront){let containerContentFront=$('<div>',{'class':'col-12 col-md-6 col-xl-6 mt-3'})
let labelContentFront=$('<label>',{'class':'form-label',html:'Content fields:'})
let inputContentFront=$('<textarea>',{id:"contentFront_"+counterFieldsFront,name:"contentFront_"+counterFieldsFront,'class':'form-control',style:'height:38px',placeholder:'Enter a content fields',maxLength:500,required:!0})
let messageContentFront=$("<div>",{'class':'msg msg_'+inputContentFront.attr('id')})
$("#content_fieldsFront").append(containerContentFront.append(labelContentFront,inputContentFront,messageContentFront))
autosize(inputContentFront)
counterFieldsFront++}})
$("#btnFileback").change(function(){chargePreviewforImage($('#preview_btnFileback'),$(this))})
$("input[name='txtNumberBack']").keyup(function(){let numberFieldsBack=$(this).val()
$("#content_fieldsBack").empty()
let counterFieldsBack=1
while(counterFieldsBack<=numberFieldsBack){let containerContentBack=$('<div>',{'class':'col-12 col-md-6 col-xl-6 mt-3'})
let labelContentBack=$('<label>',{'class':'form-label',html:'Content fields:'})
let inputContentBack=$('<textarea>',{id:"contentBack_"+counterFieldsBack,name:"contentBack_"+counterFieldsBack,'class':'form-control',style:'height:38px',placeholder:'Enter a content fields',maxLength:500,required:!0})
let messageContentBack=$("<div>",{'class':'msg msg_'+inputContentBack.attr('id')})
$("#content_fieldsBack").append(containerContentBack.append(labelContentBack,inputContentBack,messageContentBack))
autosize(inputContentBack)
counterFieldsBack++}})
$("#txtNumber-size").keyup(function(){let numberSizeFields=$(this).val()
$("#row-sizes").empty()
let counterSizeFields=1
while(counterSizeFields<=numberSizeFields){let containerDescriptionFields=$('<div>',{'class':'col-12 col-md-7 col-xl-7 mt-3'})
let labelDescriptionFields=$('<label>',{'class':'form-label',html:'Description:'})
let inputDescriptionFields=$('<input>',{type:'text',id:'txtSize_'+counterSizeFields,name:'txtSize_'+counterSizeFields,'class':'form-control',placeholder:'Enter the description',maxLength:50,required:!0})
let messageDescriptionFields=$("<div>",{'class':'msg msg_'+inputDescriptionFields.attr('id')})
$("#row-sizes").append(containerDescriptionFields.append(labelDescriptionFields,inputDescriptionFields,messageDescriptionFields))
let containerPriceFields=$('<div>',{'class':'col-12 col-md-5 col-xl-5 mt-3'})
let labelPriceFields=$('<label>',{'class':'form-label',html:'Price (The price can be 0 if the item is free):'})
let inputPriceFields=$('<input>',{type:'text',id:'txtPrice_'+counterSizeFields,name:'txtPrice_'+counterSizeFields,'class':'form-control',placeholder:'Enter the price',maxLength:15,required:!0})
let messagePriceFields=$("<div>",{'class':'msg msg_'+inputPriceFields.attr('id')})
$("#row-sizes").append(containerPriceFields.append(labelPriceFields,inputPriceFields,messagePriceFields))
counterSizeFields++}})
function validatePostcard(form){let validateForm=!0
let inputsForm=$("#"+form.attr('id')+" :input,textarea")
inputsForm.each(function(){let messageError=".msg_"+$(this).attr("id")
switch(!0){case $(this)[0].localName==="textarea"&&$(this).attr("id").includes("Instructions")&&$(this).val()==="":$(this).addClass("invalid")
$(messageError).html("The instruction is required")
validateForm=!1
break
case $(this)[0].localName==="textarea"&&$(this).val()==="":$(this).addClass("invalid")
$(messageError).html("The content is required")
validateForm=!1
break
case $(this).attr("type")=="text"&&$(this).val()==='':$(this).addClass("invalid")
$(messageError).html("The information is required")
validateForm=!1
break
case $(this).attr("type")=="file"&&$(this).get(0).files.length===0:$(this).addClass("invalid")
$(messageError).html("The file is required")
validateForm=!1
break}
$(this).keyup(function(){$(this).removeClass("invalid")
$(messageError).empty()})})
return validateForm}
$("#newPostcard").bind("submit",function(){if(validatePostcard($(this))){$.ajax({type:$(this).attr("method"),url:$(this).attr("action"),data:new FormData(this),contentType:!1,processData:!1,dataType:"json",success:function(data){if(data.message!='Successfully saved'){message("error",data.message,"#CC1E1E")}else{message("success",data.message,"#4CC522")
$("#newPostcard")[0].reset()
$('picture').remove()
$("#row-base,#row-multimedia,#row-content,#row-sizes").empty()
let div=$('<div>',{id:'quantity','class':'col-12 mt-3'})
let label=$('<label>',{'class':'form - label',html:'Quantity of multimedia:'})
let input=$('<input>',{type:'text','class':'form-control',id:'txtMultimedia',name:'txtMultimedia',placeholder:'Enter a number amount of media content',maxLength:50,required:!0})
let msg=$('<div>',{'class':'msg msg_txtMultimedia'})
$(input).keyup(function(){createPreviewforImage($(input))})
$('#type-multimedia').after(div.append(label,input,msg))
setTimeout(()=>{window.location.href=data.route},1500)}}})}
return!1})
$(".delete").on('click',function(){$("#postcard").val($(this).val())})
$("#deletePostcard").bind("submit",function(e){e.preventDefault()
$.ajax({type:$(this).attr("method"),url:$(this).attr("action"),data:new FormData(this),contentType:!1,processData:!1,success:function(data){if(data!="Successfully removed"){message("error",data,"#CC1E1E")}else{$('#deleteModal').modal('hide')
message("success",data,"#4CC522")
setTimeout(()=>{location.reload()},1500)}},})})